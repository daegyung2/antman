<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE sqlMap PUBLIC '-//ibatis.apache.org//DTD Sql Map 2.0//EN' 'http://ibatis.apache.org/dtd/sql-map-2.dtd'>

<sqlMap namespace="appointment">
 <typeAlias alias="appoint" type="admin.bean.AppointmentDTO" />
<!-- 예약넣기  --> 
<insert id="appointmentinsert"  parameterClass="appoint">
  INSERT INTO appointment(aid,name,id,jumin1,jumin2,drid,drname,adate,dpname) values(appointment_SEQ.NEXTVAL,#name#,#id#,#jumin1#,#jumin2#,#drid#,#drname#,to_date(#adate#,'YYYY-MM-DD HH24:MI'),#dpname#)</insert>


<update id="nextappointupdate1"  parameterClass="appoint">
  update appointment set adate1 = to_date(#adate#,'YYYY-MM-DD HH24:MI') where id = #id# 
   </update>
   
   <update id="nextappointupdate2"  parameterClass="appoint">
  update appointment set adate2 = #adate2# where id = #id# 
   </update>
   
   <update id="nextappointupdate3"  parameterClass="appoint">
  update appointment set adate3 = #adate3# where id = #id# 
   </update>

<!-- 간편예약 넣기  --> 
 <typeAlias alias="simpleappoint" type="admin.bean.AppointmentSimpleDTO" />
<insert id="simpleappointmentinsert"  parameterClass="simpleappoint">
  INSERT INTO simpleappointment(aid,name,jumin1,jumin2,phone1,phone2,phone3,adate,symptom,talk) values(simpleappointment_SEQ.NEXTVAL,#name#,#jumin1#,#jumin2#,#phone1#,#phone2#,#phone3#,sysdate,#symptom#,#talk#)
  </insert>
  
 <resultMap id="appointRes" class="appoint">
	  
	  <result property="aid" column="aid"/>
      <result property="id" column="id"/>
      <result property="name" column="name"/>
      <result property="drid" column="drid"/>
      <result property="drname" column="drname"/>
      <result property="dpname" column="dpname"/>
      <result property="dpname" column="dpname"/>
      <result property="adate" column="adate"/>
      <result property="adate1" column="adate1"/>
      <result property="adate2" column="adate2"/>
      <result property="adate3" column="adate3"/>
   
   </resultMap>
   <!-- 선생님마이페이지에서 보는 예약내역 -->
      <select id="drappointcheck" resultMap="appointRes">
        select aid,id,name,drid,drname,dpname,to_char(adate,'yyyy-MM-DD HH:mm')adate,to_char(adate1,'yyyy-MM-DD HH:mm')adate1,to_char(adate2,'yyyy-MM-DD HH:mm')adate2,to_char(adate3,'yyyy-MM-DD HH:mm')adate3 from appointment where drname = #drname# order by aid desc </select>
   

  <!-- 예약결과조회 출력하기  --> 
      <select id="appointresult" resultMap="appointRes">
      select aid,id,name,drname,dpname,adate from appointment where id = #id# order by aid desc 
      </select>
   
   <typeAlias alias="dsche" type="admin.bean.ScheduleDTO"/>
	
	<resultMap id="dscd" class="dsche">
	<result property="adate" column="sdate"/>
	<result property="drname" column="drname"/>	
	<result property="dpname" column="dpname"/>	
	</resultMap>
   

      

 <!-- 예약스케쥴에서 중복부분 삭제하기   --> 
 	  <resultMap id="appointRess" class="appoint">
      <result property="adate" column="adate"/>
      </resultMap>
<select id="appointscheduleselect" resultMap="appointRess" parameterClass="appoint">
	select to_char(adate ,'yyyy-MM-DD HH24:MI') adate from appointment where drid = #drid#
</select>
</sqlMap>