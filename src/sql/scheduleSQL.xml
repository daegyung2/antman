<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE sqlMap PUBLIC '-//ibatis.apache.org//DTD Sql Map 2.0//EN' 'http://ibatis.apache.org/dtd/sql-map-2.dtd'>
<sqlMap namespace="schedule">
	
	<!-- 의사스케쥴 -->
	<typeAlias alias="dsche" type="admin.bean.ScheduleDTO"/>
	
	<resultMap id="dsc" class="dsche">
	<result property="sid" column="sid"/>	
	<result property="drid" column="drid"/>
	<result property="drname" column="drname"/>
	<result property="dpname" column="dpname"/>
	<result property="sdate" column="sdate"/>
	<result property="adate" column="adate"/>
	<result property="ttview" column="ttview"/>
	<result property="stevent" column="stevent"/>
	
	</resultMap>
	
	<insert id="scheduleinsert" parameterClass ="dsche">
	INSERT INTO schedule(sid,drid,drname,dpname,sdate) values(schedule_SEQ.NEXTVAL,#drid#,#drname#,#dpname#,to_date(#sdate#,'YYYY-MM-DD HH24:MI'))
	</insert>

	<update id="nextscheduleupdate1"  parameterClass="dsche">
  update schedule set sdate1 = #sdate# where id = #id# 
   </update>
   
   <update id="nextscheduleupdate2"  parameterClass="dsche">
  update schedule set sdate2 = #sdate# where id = #id# 
   </update>
   
   <update id="nextscheduleupdate3"  parameterClass="dsche">
  update schedule set sdate3 = #sdate# where id = #id# 
   </update>
	
	
	
	<resultMap id="ddsc" class="dsche">
	<result property="sid" column="sid"/>	
	<result property="drname" column="drname"/>
	<result property="dpname" column="dpname"/>
	<result property="sdate" column="sdate"/>
	<result property="sdate1" column="sdate1"/>
	<result property="sdate2" column="sdate2"/>
	<result property="sdate3" column="sdate3"/>
	</resultMap>
	
	<select id="drschedulecheck" resultMap="ddsc"  >
	  select sid,drname,dpname,sdate,sdate1,sdate2,sdate3 from schedule where drname = #drname# order by sid desc
	
	</select>
	
	 <!-- 예약스케쥴에서 중복부분 삭제하기   --> 
	<typeAlias alias="dsche" type="admin.bean.ScheduleDTO"/>
	
	<resultMap id="dscd" class="dsche">
	<result property="sdate" column="sdate"/>
	<result property="sdate1" column="sdate1"/>
	<result property="sdate2" column="sdate2"/>
	<result property="sdate3" column="sdate3"/>
	<result property="drname" column="drname"/>	
	<result property="dpname" column="dpname"/>	
	</resultMap>
	
	<select id="scheduleselect" resultMap="dscd" parameterClass="int">
		select to_char(sdate ,'YYYY-MM-DD HH:mm')sdate,drid,to_char(sdate1 ,'YYYY-MM-DD HH:mm')sdate1,to_char(sdate2 ,'YYYY-MM-DD HH:mm')sdate2,to_char(sdate3 ,'YYYY-MM-DD HH:mm')sdate3, drname, dpname from schedule where drid = #drid#
	</select>
	<!-- 의사 꺼 -->




</sqlMap>