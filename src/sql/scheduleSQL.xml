<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE sqlMap PUBLIC '-//ibatis.apache.org//DTD Sql Map 2.0//EN' 'http://ibatis.apache.org/dtd/sql-map-2.dtd'>
<sqlMap namespace="schedule">
	
	<!-- 의사스케쥴 -->
	<typeAlias alias="dsche" type="admin.bean.ScheduleDTO"/>
	
	<resultMap id="dsc" class="dsche">
	<result property="sid" column="sid"/>	
	<result property="drid" column="drid"/>
	<result property="drname" column="drname"/>
	<result property="dpname" column="dpname"/>
	<result property="sdate" column="sdate"/>
	<result property="adate" column="adate"/>
	<result property="ttview" column="ttview"/>
	<result property="stevent" column="stevent"/>
	
	</resultMap>
	
	<insert id="scheduleinsert" parameterClass ="dsche">
	INSERT INTO schedule(sid,drid,drname,dpname,sdate) values(schedule_SEQ.NEXTVAL,#drid#,#drname#,#dpname#,to_date(#sdate#,'YYYY-MM-DD HH24:MI'))
	</insert>

		<insert id="nextscheduleinsert" parameterClass ="dsche">
	INSERT INTO schedule(sid,drid,id,name,drname,dpname,sdate,nextsdate) values(schedule_SEQ.NEXTVAL,#drid#,#id#,#name#,#drname#,#dpname#,to_date(#sdate#,'YYYY-MM-DD HH24:MI'),#nextsdate#)
	</insert>
	
	<update id="scheduleupdatename" parameterClass="dsche" >
		update schedule set id = #id#, name = #name# , nextsdate = '1차진료' where sid = #sid#
	</update>
	
	
	<delete id="scheduledelete" parameterClass="int" >
		delete schedule where sid = #sid#
	</delete>
	
	<select id="drschedulecheck" resultClass="dsche" >
	  select sid,drname,dpname,name,to_char(sdate,'YYYY-MM-DD HH:MI')sdate,nextsdate from schedule where drid = #drid# order by sid desc
	</select>
	
	<select id="drsnameidcheck" resultClass="dsche" >
	 	  select name,id from schedule where drid = #drid#
	</select>
	
	 <!-- 예약스케쥴에서 중복부분 삭제하기   --> 
	<typeAlias alias="dsche" type="admin.bean.ScheduleDTO"/>
	
	<resultMap id="dscd" class="dsche">
	<result property="sdate" column="sdate"/>
	<result property="drname" column="drname"/>	
	<result property="dpname" column="dpname"/>	
	</resultMap>
	
	<select id="scheduleselectshit" resultClass="dsche" >
		select sid,drname,dpname,to_char(sdate ,'YYYY-MM-DD HH:MI')sdate from schedule where drid = #drid# and to_char(sdate ,'YYYY-MM-DD') = #sdate#
	</select>
	
	
	<select id="scheduleselect" resultMap="dscd" parameterClass="int">
		select to_char(sdate ,'YYYY-MM-DD HH:MI')sdate,drid, drname, dpname from schedule where drid = #drid#
	</select>
	<!-- 의사 꺼 -->


	<select id="drappointcheck" resultClass="dsche" parameterClass="int">
		select * from schedule where drid = #drid#
	</select>

</sqlMap>